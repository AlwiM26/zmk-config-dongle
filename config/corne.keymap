/*
 * Copyright (c) 2020 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/outputs.h>

/ {
    behaviors {
        hm: homerow_mods {
            compatible = "zmk,behavior-hold-tap";
            label = "HOMEROW_MODS";
            bindings = <&kp>, <&kp>;

            #binding-cells = <2>;
            tapping-term-ms = <200>;
            flavor = "tap-preferred";
            require-prior-idle-ms = <125>;
            quick-tap-ms = <200>;
        };

        shifthr: shifthr {
            compatible = "zmk,behavior-hold-tap";
            label = "SHIFTHR";
            bindings = <&kp>, <&kp>;

            #binding-cells = <2>;
            tapping-term-ms = <185>;
            flavor = "tap-preferred";
            quick-tap-ms = <185>;
        };

        weak: weak {
            compatible = "zmk,behavior-hold-tap";
            label = "WEAK";
            bindings = <&kp>, <&kp>;

            #binding-cells = <2>;
            tapping-term-ms = <230>;
            flavor = "tap-preferred";
            require-prior-idle-ms = <125>;
            quick-tap-ms = <230>;
        };
    };

    combos {
        compatible = "zmk,combos";

        caps {
            bindings = <&kp CAPS>;
            key-positions = <16 19>;
        };

        esc {
            bindings = <&kp ESCAPE>;
            key-positions = <2 3>;
        };

        quote {
            bindings = <&kp SQT>;
            key-positions = <20 21>;
        };

        settings {
            bindings = <&sl 3>;
            key-positions = <38 39>;
        };
    };

    macros {
        save: save {
            compatible = "zmk,behavior-macro";
            #binding-cells = <0>;
            bindings = <&macro_tap>, <&kp ESCAPE &kp COLON &kp W &kp ENTER>;

            label = "SAVE";
        };
    };

    keymap {
        compatible = "zmk,keymap";

        Home-0 {
            display-name = "HOME";
            bindings = <
&none  &kp Q              &kp W             &kp E                    &kp R                  &kp T          &kp Y        &kp U              &kp I             &kp O              &kp P                      &none
&none  &weak LEFT_META A  &weak LEFT_ALT S  &shifthr LEFT_CONTROL D  &shifthr LEFT_SHIFT F  &kp G          &kp H        &shifthr RSHIFT J  &shifthr RCTRL K  &weak RIGHT_ALT L  &weak RIGHT_GUI SEMICOLON  &none
&none  &kp Z              &kp X             &kp C                    &kp V                  &kp B          &kp N        &kp M              &kp COMMA         &kp DOT            &kp SLASH                  &none
                                            &none                    &lt 1 TAB              &lt 2 SPACE    &lt 2 ENTER  &lt 1 BACKSPACE    &none
            >;
        };

        Num-1 {
            display-name = "NUM";
            bindings = <
&none  &kp NUMBER_1                 &kp NUMBER_2            &kp NUMBER_3         &kp NUMBER_4                &kp N5           &kp NUMBER_6   &kp NUMBER_7                    &kp N8                           &kp N9                            &kp NUMBER_0                       &none
&none  &weak LEFT_META EXCLAMATION  &weak LEFT_ALT AT_SIGN  &shifthr LCTRL HASH  &shifthr LEFT_SHIFT DOLLAR  &kp PERCENT      &kp CARET      &shifthr RIGHT_SHIFT AMPERSAND  &shifthr RIGHT_CONTROL ASTERISK  &weak RIGHT_ALT LEFT_PARENTHESIS  &weak RIGHT_GUI RIGHT_PARENTHESIS  &none
&none  &none                        &none                   &none                &none                       &kp GRAVE        &kp BACKSLASH  &kp MINUS                       &kp EQUAL                        &kp LEFT_BRACKET                  &kp RIGHT_BRACKET                  &none
                                                            &none                &kp DEL                     &kp LG(SPACE)    &save          &kp LC(BACKSPACE)               &none
            >;
        };

        Nav-2 {
            display-name = "NAV";
            bindings = <
&none  &kp F1              &kp F2             &kp F3             &kp F4                  &none        &kp END           &kp PAGE_DOWN  &kp PG_UP        &kp HOME    &none  &none
&none  &weak LEFT_META F5  &weak LEFT_ALT F6  &shifthr LCTRL F7  &shifthr LEFT_SHIFT F8  &kp LC(C)    &kp LEFT_ARROW    &kp DOWN       &kp UP_ARROW     &kp RIGHT   &none  &none
&none  &kp F9              &kp F10            &kp F11            &kp F12                 &kp LC(V)    &kp C_PREV        &kp C_VOL_DN   &kp C_VOLUME_UP  &kp C_NEXT  &none  &none
                                              &none              &none                   &none        &kp C_PLAY_PAUSE  &none          &none
            >;
        };

        Setting-3 {
            display-name= "SETTINGS";
            bindings = <
&none  &none  &none  &none  &none  &bt BT_SEL 0    &bt BT_SEL 1  &none  &none  &none  &none  &none
&none  &none  &none  &none  &none  &bt BT_SEL 2    &bt BT_CLR    &none  &none  &none  &none  &none
&none  &none  &none  &none  &none  &out OUT_TOG    &none         &none  &none  &none  &none  &none
                     &none  &none  &none           &none         &none  &none
            >;
        };
    };
};
